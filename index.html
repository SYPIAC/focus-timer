<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Custom Focus Timer</title>
  <style>
    body {
      transition: background-color 0.5s ease; /* Smooth transition for background color change */
    }
    table {
      border-collapse: collapse;
      width: 100%;
    }
    th, td {
      border: 1px solid #dddddd;
      text-align: left;
      padding: 8px;
    }
    th {
      background-color: #f2f2f2;
    }    
  </style>
</head>
<body>
  <h1>Custom Focus Timer</h1>
  <div>Every 3 seconds working earns 1 second break</div>
  <button onclick="startWork()">Start Work</button>
  <button onclick="endWork()">End Work</button>
  <button onclick="startBreak()">Start Break</button>
  <div id="timerDisplay"></div>
  <div id="workTimeDisplay">Work time: 00:00:00 </div>
  <div id="breakTimeDisplay">Break time earned total: 00:00:00</div>
  <div id="breakTimeBudgetDisplay">Break time left: 00:00:00</div>

  <script>
    let workStartTime = new Date();
    let workEndTime = 0;
    let breakTime = 0;
    let workInterval;
    let breakInterval;
    let elapsedTime = 0;
    let remainingBreakTime = 0;

    function startWork() {
      clearInterval(breakInterval);
      document.getElementById('timerDisplay').innerText = "WORKING";
      workInterval = setInterval(updateWorkTime, 1000); // Update every second
      document.body.style.backgroundColor = 'lightcoral'; // Change background to redish color
    }

    function endWork() {
      clearInterval(workInterval);
      clearInterval(breakInterval);
      workEndTime = new Date();
      let workDuration = (workEndTime - workStartTime) / 1000; // duration in seconds
      elapsedTime = 0; breakTime = 0; remainingBreakTime = 0;
      document.getElementById('timerDisplay').innerText = `Work ended.`;
      document.getElementById('breakTimeDisplay').innerText = `Break time earned: ${formatTime(breakTime)}`;
      document.getElementById('breakTimeBudgetDisplay').innerText = `Break time left: ${formatTime(remainingBreakTime)}`;
    }

    function startBreak() {
      clearInterval(workInterval);
      document.getElementById('timerDisplay').innerText = `BREAK TIME`;
      document.body.style.backgroundColor = 'lightblue'; // Change background to light blue color
      breakInterval = setInterval(updateBreakTime, 1000);
    }

    function updateWorkTime() {
      elapsedTime += 1;
      document.getElementById('workTimeDisplay').innerText = `Work time: ${formatTime(elapsedTime)}`;
      if (elapsedTime % 3 === 0) { // Update break time earned every 3 seconds
        breakTime += 1;
        remainingBreakTime += 1;
        document.getElementById('breakTimeDisplay').innerText = `Break time earned: ${formatTime(breakTime)}`;
        document.getElementById('breakTimeBudgetDisplay').innerText = `Break time left: ${formatTime(remainingBreakTime)}`;
      }
    }

    function updateBreakTime() {
      remainingBreakTime -= 1;
      document.getElementById('breakTimeBudgetDisplay').innerText = `Break time left: ${formatTime(remainingBreakTime)}`;
    }

    function formatTime(totalSeconds) {
        const hours = Math.floor(Math.abs(totalSeconds) / 3600);
        const minutes = Math.floor((Math.abs(totalSeconds) % 3600) / 60);
        const seconds = Math.abs(totalSeconds) % 60;
        const sign = totalSeconds < 0 ? '-' : ''; // Add sign for negative times
        return `${sign}${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    }

  </script>
</body>
</html>
